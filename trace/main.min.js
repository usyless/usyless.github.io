var e=!0;const g=[],aa=[];
async function p(a,{v:b=[],buttons:c,u:d=[],onclose:f}={}){q();e=!1;return new Promise(k=>{const l=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div");l.setAttribute("usy-overlay","");l.classList.add("fullscreen","blur");r.classList.add("popupOuter",...d);n.classList.add("popupInner",...d);const m=[];if("string"===typeof a){var t=document.createElement("div");t.classList.add("popupText");t.textContent=a;m.push(t)}else Array.isArray(a)?m.push(...a):m.push(a);
r.appendChild(n);if("string"===typeof c||null==c){t=document.createElement("div");t.classList.add("popupButtons");const h=document.createElement("button");h.classList.add("standardButton");h.textContent=c??"Ok";t.appendChild(h);h.addEventListener("click",()=>{const M=a.B?.();q();k(M??!0)})}else t=c;n.append(...m,t);l.addEventListener("click",h=>{h.target===h.currentTarget&&(q(),k(!1))});l.appendChild(r);b.push({target:window,type:"keydown",listener:h=>{"escape"===h.key.toLowerCase()&&l.click()}});
for(const h of b)g.push(h),h.target.addEventListener(h.type,h.listener);null!=f&&aa.push(f);document.body.appendChild(l)})}function q(){e=!0;for(const a of g)a.target?.removeEventListener?.(a.type,a.listener);for(const a of aa)a();aa.length=0;g.length=0;document.querySelectorAll("[usy-overlay]").forEach(a=>a.remove())};const u={FRHigher:2E4,FRLower:20,colourTolerance:67,PPO:48,delimitation:"tab",lowFRExport:20,highFRExport:2E4,SPLHigher:"",SPLLower:""};document.getElementById("restoreDefault").addEventListener("click",()=>{ba();p("Restored settings to default")});function ba(){for(const a in u)document.getElementById(a).value=u[a]}let v,w,x,ca,y=null,z=null;const A=document.getElementById("glass");A.j=A.querySelector("img");A.D=a=>{A.style.borderColor=`rgb(${a})`};
A.o=()=>{B.l()&&(A.j.src=B.src,A.j.width=3*B.clientWidth,A.j.height=3*B.clientHeight)};
var da=()=>{document.querySelector('.waiting-overlay[data-for="trace"]').classList.remove("enabled")},C=document.getElementById("lines"),D={xHigh:document.getElementById("xHigh"),xLow:document.getElementById("xLow"),yHigh:document.getElementById("yHigh"),yLow:document.getElementById("yLow")},ea=(a,b)=>{const c=a.dataset.direction;a.nextElementSibling.setAttribute(c,b);a.setAttribute(`${c}1`,b);a.setAttribute(`${c}2`,b)},fa=()=>{for(const a of C.querySelectorAll("line"))a.setAttribute("stroke-width",
v);for(const a of C.querySelectorAll("text"))a.setAttribute("font-size",`${1.3*v}em`)},E=a=>parseFloat(a.getAttribute(`${a.dataset.direction}1`)),F=(a,b)=>{const c=E(D[a.dataset.other]),d="x"===a.dataset.direction?w:x;a===D.xHigh||a===D.yLow?ea(a,Math.max(c+1,Math.min(d-1,b))):ea(a,Math.max(1,Math.min(c-1,b)))},G=()=>C.classList.remove("hidden"),I=()=>C.classList.add("hidden"),ha=()=>{for(const a of J){const [b,c]="x"===a.dataset.direction?["y",x]:["x",w];a.setAttribute(`${b}1`,"0");a.setAttribute(`${b}2`,
c)}D.xHigh.nextElementSibling.setAttribute("y",(x/2).toString());D.xLow.nextElementSibling.setAttribute("y",(x/2).toString());D.yHigh.nextElementSibling.setAttribute("x",(w/2).toString());D.yLow.nextElementSibling.setAttribute("x",(w/2).toString())},J=[D.xHigh,D.xLow,D.yHigh,D.yLow],ja=()=>{ia.classList.remove("hidden");K.setAttributeNS(null,"width","0")},ka=()=>{document.getElementById("erasing").classList.add("hidden")},ia,K,N;ia=document.getElementById("erasing");K=ia.firstElementChild;
const B=document.getElementById("uploadedImage");B.g=a=>{const b=B.getBoundingClientRect(),c=a.clientX;a=a.clientY;return{x:c,y:a,xRel:c-b.left,yRel:a-b.top}};B.l=()=>B.src.startsWith("blob:");B.C=()=>{const a=O.get(B.src),b={};if(a){for(const c in D)b[c]=E(D[c]);a.lines=b}};B.A=()=>{const a=O.get(B.src).lines;for(const b in D)F(D[b],a[b]);ha();G()};const ma=a=>{p(a).then(()=>ma(a)).catch(()=>ma(a))};
var na=()=>{for(const a of document.querySelectorAll("#sidebar [data-default]"))a.textContent=a.dataset["default"];y=null;z?.()},oa=a=>{document.getElementById("undo").disabled=!a.undo;document.getElementById("redo").disabled=!a.redo};
const pa=["selectPath","selectPoint","eraseRegion"],qa={path:I,point:I,erase:()=>{I();ja()}},ra={path:G,point:G,erase:()=>{ka();G()}},sa=a=>{a=a.target;const b=a.dataset.mode,c=JSON.parse(JSON.stringify(y));na();c===b?(z?.(),y=null):(a.textContent=a.dataset.active,z?.(),z=ra[b],y=b,qa[b]())};for(const a of pa)document.getElementById(a).addEventListener("click",sa);
var ua=(()=>{const a=new Worker("./a.out.js");a.onmessage=b=>{b=b.data;var c=b.type;switch(c){case "exportTrace":const d=document.createElement("a"),f=URL.createObjectURL(new Blob([b["export"]],{type:"text/plain;charset=utf-8"}));d.href=f;b=document.createElement("div");c=document.createElement("div");const k=document.createElement("input");c.textContent="Export file name";k.placeholder="trace";k.type="text";k.classList.add("sidebarSection");b.append(c,k);b.classList.add("exportBox");b.B=()=>k.value;
p(b,{buttons:"Save Trace"}).then(l=>{!1!==l&&(d.download=l||"trace.txt",d.click());URL.revokeObjectURL(f)});setTimeout(()=>{k.focus()},50);break;case "error":da();ma(b.message);break;case "getHistoryStatus":oa(b);break;case "setData":console.timeEnd("Initialise image");break;default:B.src===b.src&&("getPixelColour"===c?A.D(b.pixelColour):"snapLine"===c?(F(D[b.line.name],b.line.position),b["final"]&&(E(D.xHigh)<.2*w&&F(D.xHigh,w),E(D.xLow)>.8*w&&F(D.xLow,0),E(D.yHigh)>.8*x&&F(D.yHigh,0),E(D.yLow)<
.2*x&&F(D.yLow,x))):(ta(b.svg),da(),P({type:"getHistoryStatus"})))}};return a})(),P=a=>B.l()&&ua.postMessage({src:B.src,...a}),va=(a,b)=>{P({type:"eraseRegion",begin:a,end:b})},wa=()=>{P({type:"autoTrace",colourTolerance:document.getElementById("colourTolerance").value||u.colourTolerance})},Q=(a,b,c=!1)=>{P({type:"snapLine",line:{name:a.id,position:E(a),direction:a.dataset.direction},direction:b,final:c})},ta=a=>{var b=document.getElementById("trace");const c=b.lastElementChild;b=b.firstElementChild;
c.setAttribute("d",a);c.setAttribute("stroke","#ff0000");c.setAttribute("stroke-width",ca);b.setAttribute("d",a);b.setAttribute("stroke-width",(1.5*ca).toString())};document.getElementById("autoPath").addEventListener("click",wa);document.getElementById("undo").addEventListener("click",()=>P({type:"undoTrace"}));document.getElementById("redo").addEventListener("click",()=>P({type:"redoTrace"}));document.getElementById("clearPath").addEventListener("click",()=>P({type:"clearTrace"}));
document.getElementById("export").addEventListener("click",()=>{const a=c=>Object.values(c).some(d=>d&&"object"===typeof d?a(d):null==d||""===d),b={type:"exportTrace",PPO:document.getElementById("PPO").value||u.F,delim:document.getElementById("delimitation").value||u.delimitation,lowFR:document.getElementById("lowFRExport").value||u.lowFRExport,highFR:document.getElementById("highFRExport").value||u.highFRExport,SPL:{top:document.getElementById("SPLHigher").value,topPixel:E(D.yHigh),bottom:document.getElementById("SPLLower").value,
bottomPixel:E(D.yLow)},FR:{top:document.getElementById("FRHigher").value,topPixel:E(D.xHigh),bottom:document.getElementById("FRLower").value,bottomPixel:E(D.xLow)}};a(b)?p("Please fill in all required values to export (SPL and FR values)"):P(b)});document.getElementById("smoothTrace").addEventListener("click",()=>P({type:"smoothTrace"}));const O=new Map,R=document.getElementById("fileInput");
var xa=document.getElementById("imageQueueInner"),ya=a=>{O.delete(a.src);P({type:"removeImage",src:a.src});URL.revokeObjectURL(a.src);a.remove()},za=()=>{xa.querySelector('img[class="selectedImage"]').scrollIntoView({inline:"center",behavior:"smooth"})},Ba=(a,b=!1)=>{const c=document.createElement("img"),d=document.getElementById("imageQueueInner");c.src=a;O.set(c.src,{initial:!0});c.addEventListener("dragstart",f=>f.preventDefault());c.addEventListener("click",f=>{f.preventDefault();f.stopPropagation();
B.C();B.src=a;for(const k of xa.querySelectorAll('img[class="selectedImage"]'))k.classList.remove("selectedImage");c.classList.add("selectedImage");za()});c.addEventListener("contextmenu",f=>{f.preventDefault();c.classList.contains("selectedImage")&&(f=c.nextElementSibling,f||(f=c.previousElementSibling),f?f.click():Aa());ya(c)});d.appendChild(c);b&&(c.click(),setTimeout(()=>za(),50))};document.getElementById("removeImage").addEventListener("click",()=>document.querySelector('img[class="selectedImage"]')?.dispatchEvent(new Event("contextmenu")));
document.getElementById("toggleImageQueue").addEventListener("click",a=>{a=a.target;document.getElementById("imageContainer").addEventListener("transitionend",()=>window.dispatchEvent(new Event("resize")),{once:!0});a.textContent===a.dataset.active?(a.textContent=a.dataset["default"],a.removeAttribute("active")):(a.textContent=a.dataset.active,a.setAttribute("active",""))});
document.getElementById("editImage").addEventListener("click",()=>{if(B.l()){const d=document.createElement("div");var a=document.createElement("h3"),b=document.createElement("div"),c=document.createElement("button");const f=document.createElement("div"),k=document.createElement("img");d.id="editContainer";d.append(a,b,f);f.append(k);f.classList.add("cropWrapper");k.draggable=!1;a.textContent="Edit Image";b.appendChild(c);c.textContent="Invert";c.classList.add("standardButton");k.src=B.src;c.addEventListener("click",
()=>k.classList.toggle("inverted"));a=document.createElement("div");a.classList.add("popupButtons");b=document.createElement("button");c=document.createElement("button");b.classList.add("standardButton");b.textContent="Cancel";c.classList.add("standardButton");c.textContent="Save";a.append(b,c);b.addEventListener("click",q);c.addEventListener("click",()=>{const l=document.createElement("canvas"),r=l.getContext("2d");l.width=w;l.height=x;r.drawImage(k,0,0);if(k.classList.contains("inverted")){const n=
r.getImageData(0,0,w,x),m=n.data,t=m.length;for(let h=0;h<t;h+=4)m[h]=255-m[h],m[h+1]=255-m[h+1],m[h+2]=255-m[h+2];r.putImageData(n,0,0)}document.getElementById("removeImage").click();l.toBlob(n=>{Ba(URL.createObjectURL(n),!0);q()})},{once:!0});p(d,{buttons:a})}else p("No valid image selected")});ba();Aa();R.m=a=>{a=Array.from(a).filter(c=>c.type.startsWith("image/"));const b=a.length-1;0<a.length?(q(),a.forEach((c,d)=>{c=URL.createObjectURL(c);Ba(c,d===b)})):p("Invalid image/file(s) added!")};
R.addEventListener("change",a=>{R.m(a.target.files)});B.addEventListener("dragstart",a=>a.preventDefault());document.getElementById("fileInputButton").addEventListener("click",()=>R.click());document.addEventListener("paste",a=>{a.preventDefault();const b=new DataTransfer;for(const c of a.clipboardData.items)"file"===c.kind&&b.items.add(c.getAsFile());0<b.files.length&&R.m(b.files)});S("dragover",document.body,a=>{a.preventDefault();a.dataTransfer.dropEffect="copy";document.body.classList.add("lowOpacity")});
S(["dragleave","dragend"],document.body,a=>{a.preventDefault();document.body.classList.remove("lowOpacity")});S("drop",document.body,a=>{a.preventDefault();document.body.classList.remove("lowOpacity");R.m(a.dataTransfer.files)});
B.addEventListener("pointermove",a=>{if("erase"!==y){a.preventDefault();const b=B.parentElement,c=b.getBoundingClientRect();a=B.g(a);A.style.left=`${Math.min(a.x-c.left,b.clientWidth-A.clientWidth)}px`;A.style.top=`${Math.min(a.y-c.top,b.clientHeight-A.clientHeight)}px`;A.j.style.left=`${-1*(3*a.xRel-A.clientWidth/2)}px`;A.j.style.top=`${-1*(3*a.yRel-A.clientHeight/2)}px`;P({type:"getPixelColour",x:a.xRel*v,y:a.yRel*v});A.classList.remove("hidden")}});
S(["pointerleave","pointerout","pointercancel"],B,()=>A.classList.add("hidden"));let T=null,Ca=B.g;C.addEventListener("pointerdown",a=>{const b=Ca(a);a={x:.02*w,y:.02*x};for(var c of J)c.offset=b[`${c.dataset.direction}Rel`]*v-E(c);c=J.reduce((d,f)=>Math.abs(f.offset)<Math.abs(d.offset)?f:d,J[0]);Math.abs(c.offset)<a[c.dataset.direction]&&(T=c)});C.addEventListener("pointermove",a=>{T&&F(T,Ca(a)[`${T.dataset.direction}Rel`]*v-T.offset)});
S(["pointerup","pointerleave","pointercancel"],C,a=>{a.preventDefault();T=null});let U,Da,Ea=document.getElementById("snapToLines").checked;document.getElementById("snapToLines").addEventListener("change",()=>Ea=document.getElementById("snapToLines").checked);
document.getElementById("buttonSection").addEventListener("pointerdown",a=>{const b=a.target,c=b.parentNode;!U&&c.classList.contains("moveButtons")&&(a.preventDefault(),Da=D[c.dataset["for"]],Ea?Q(D[c.dataset["for"]],parseInt(b.dataset.direction,10)):U=setInterval(()=>{F(Da,E(Da)+parseInt(b.dataset.direction,10)*v)},10))});S(["pointerup","pointerleave","pointerout","pointercancel"],document.getElementById("buttonSection"),a=>{a.preventDefault();clearInterval(U);U=null});
window.addEventListener("resize",()=>{v=w/B.clientWidth;fa();A.o()});const Fa={path:(a,b)=>{P({type:"trace",x:a,y:b,colourTolerance:document.getElementById("colourTolerance").value||u.colourTolerance})},point:(a,b)=>P({type:"addPoint",x:a,y:b})};B.addEventListener("pointerup",a=>{null!=y&&(a=B.g(a),Fa[y]?.(a.xRel*v,a.yRel*v))});let V=!1;
B.addEventListener("pointerdown",a=>{"erase"===y&&(a.preventDefault(),V=!0,a=B.g(a).xRel*v,ja(),N=Math.max(Math.min(+a,w),0),K.setAttributeNS(null,"x",a),document.addEventListener("pointerup",Ga,{once:!0}))});B.addEventListener("pointermove",a=>{V&&"erase"===y&&(a.preventDefault(),a=B.g(a).xRel*v,a=+a,a<N?(K.setAttributeNS(null,"width",`${N-a}px`),K.setAttributeNS(null,"x",a)):(K.setAttributeNS(null,"width",`${a-N}px`),K.setAttributeNS(null,"x",N.toString())))});
const Ga=a=>{V&&"erase"===y&&(a.preventDefault(),V=!1,a=B.g(a).xRel*v,a=Math.max(Math.min(+a,w),0),va(...(N<a?[N,a]:[a,N])),K.setAttributeNS(null,"width","0"))};
B.addEventListener("load",()=>{document.getElementById("defaultMainText").classList.add("hidden");for(var a of document.querySelectorAll("[data-disabled]"))a.disabled=!1;na();w=B.naturalWidth;x=B.naturalHeight;ca=.003*Math.max(w,x);v=w/B.clientWidth;ka();for(var b of document.querySelectorAll("svg"))b.setAttribute("width",w),b.setAttribute("height",x),b.setAttribute("viewBox",`0 0 ${w} ${x}`);ta("");A.o();a=O.get(B.src);if(a.initial){document.querySelector('.waiting-overlay[data-for="trace"]').classList.add("enabled");
console.time("Initialise image");b=w;var c=x,d=document.createElement("canvas");const f=d.getContext("2d");d.width=b;d.height=c;f.drawImage(B,0,0);d=f.getImageData(0,0,b,c);ua.postMessage({src:B.src,type:"setData",data:d.data,width:b,height:c},[d.data.buffer]);F(D.xHigh,w);F(D.xLow,0);F(D.yHigh,0);F(D.yLow,x);ha();G();Q(D.xHigh,-1);Q(D.xLow,1);Q(D.yHigh,1);Q(D.yLow,-1,!0);wa();a.initial=!1}else P({type:"setCurrent"}),B.A(),P({type:"getCurrentPath"});fa()});
B.addEventListener("error",()=>{if(B.l()){for(const a of xa.querySelectorAll('img[class="selectedImage"]'))ya(a);p("Error loading this image, it may be malformed")}});
const W=new PointerEvent("pointerdown",{bubbles:!0}),X=new PointerEvent("pointerup",{bubbles:!0}),Ha={z:a=>a.ctrlKey&&document.getElementById(a.shiftKey?"redo":"undo").click(),a:()=>document.getElementById("autoPath").click(),t:()=>document.getElementById("selectPath").click(),p:()=>document.getElementById("selectPoint").click(),h:()=>document.getElementById("toggleImageQueue").click(),s:a=>document.getElementById(a.ctrlKey?"export":"smoothTrace").click(),e:a=>document.getElementById(a.ctrlKey?"editImage":
"eraseRegion").click(),enter:()=>document.getElementById("fileInputButton").click(),"delete":()=>document.getElementById("removeImage").click(),backspace:()=>document.getElementById("clearPath").click(),arrowup:a=>document.querySelector(`[data-for="y${a.shiftKey?"Low":"High"}"] > [data-direction="-1"]`).dispatchEvent(W),arrowdown:a=>document.querySelector(`[data-for="y${a.shiftKey?"Low":"High"}"] > [data-direction="1"]`).dispatchEvent(W),arrowleft:a=>document.querySelector(`[data-for="x${a.shiftKey?
"Low":"High"}"] > [data-direction="-1"]`).dispatchEvent(W),arrowright:a=>document.querySelector(`[data-for="x${a.shiftKey?"Low":"High"}"] > [data-direction="1"]`).dispatchEvent(W)},Ia={arrowup:a=>document.querySelector(`[data-for="y${a.shiftKey?"Low":"High"}"] > [data-direction="-1"]`).dispatchEvent(X),arrowdown:a=>document.querySelector(`[data-for="y${a.shiftKey?"Low":"High"}"] > [data-direction="1"]`).dispatchEvent(X),arrowleft:a=>document.querySelector(`[data-for="x${a.shiftKey?"Low":"High"}"] > [data-direction="-1"]`).dispatchEvent(X),
arrowright:a=>document.querySelector(`[data-for="x${a.shiftKey?"Low":"High"}"] > [data-direction="1"]`).dispatchEvent(X)};document.addEventListener("keydown",a=>{if(e){const b=Ha[a.key.toLowerCase()];!a.target.closest("input")&&b&&(a.preventDefault(),b(a))}});document.addEventListener("keyup",a=>{if(e){const b=Ia[a.key.toLowerCase()];!a.target.closest("input")&&b&&(a.preventDefault(),b(a))}});
document.getElementById("themeSwitch").addEventListener("click",()=>{const a=document.documentElement.classList.contains("theme-dark")?"dark":"light",b="dark"===a?"light":"dark";"dark"===b?document.getElementById("themeSwitch").textContent="\u2600\ufe0f":document.getElementById("themeSwitch").textContent="\ud83c\udf11";document.documentElement.classList.add("theme-transition");document.documentElement.classList.remove(`theme-${a}`);document.documentElement.classList.add(`theme-${b}`);window.localStorage.setItem("theme",
b);setTimeout(()=>{document.documentElement.classList.remove("theme-transition")},200)});document.documentElement.classList.contains("theme-dark")?document.getElementById("themeSwitch").textContent="\u2600\ufe0f":document.getElementById("themeSwitch").textContent="\ud83c\udf11";function S(a,b,c){for(const d of Array.isArray(a)?a:[a])b.addEventListener(d,c)}
function Aa(){document.getElementById("defaultMainText").classList.remove("hidden");for(const a of document.querySelectorAll("[data-disabled]"))a.disabled=!0;na();I();ka();ta("");B.src=""}const Ja=a=>{a=a.target;a.value<a.min&&(a.value=a.min)};for(const a of["FRLower","colourTolerance","lowFRExport"])document.getElementById(a).addEventListener("change",Ja);const Y=[{i:"Welcome to UsyTrace",body:"<h2>Here you can trace frequency responses from images</h2>\n\nAll you need to know, as well as keybindings are on the next few pages"},{i:"Tracing",body:"<h3>Auto Trace (a)</h3>\nTries to automatically select a line in the image, may fail, applied automatically upon image import\n    \n<h3>Select Path (t)</h3>\nTraces to the right of the point you click on the image, can complete a trace by starting from the left side of the frequency response and clicking to the right if it misses a part\n\n<h3>Add Point (p)</h3>\nAdd a single point to the trace manually, useful for situations where Select Path or Auto Trace Fails\n\n<h3>Smooth Trace (s)</h3>\nSmooths out sudden bumps in the traced line, good for if the original image is bad and the traced line is inconsistent\n\n<h3>Undo (Ctrl + z)</h3>\nGoes back to the previous trace step, saves add point, tracing, and clearing history\n\n<h3>Redo (Ctrl + Shift + z)</h3>\nGoes back to recently undone trace steps\n\n<h3>Erase Region (e)</h3>\nSelect a region to erase a trace from by dragging a box around the area\n\n<h3>Clear Path (Backspace)</h3>\nClears the current trace on screen, can go back using Undo"},
{i:"Exporting",body:"Align <b>High</b> and <b>Low</b> lines with given values in their respective axis, then input the respective values into <b>Higher SPL</b>, <b>Lower SPL</b>, <b>Higher Frequency</b> and <b>Lower Frequency</b>.\n\nThe lines can be moved with the arrow keys, defaulting to the <b>High</b> line for each axis, but can control the <b>Low</b> line by holding <b>Shift</b>\n\n<h3>Trace Settings</h3>     \nAdjust the <b>Minimum Exported Frequency</b>, <b>Maximum Exported Frequency</b>, <b>Points Per Octave of the exported data</b>, and <b>the delimitation of the exported data</b>\n\nThen <b>Export Trace</b> will give you the result"},
{i:"Settings",body:"<h3>Buttons Snap To Axis</h3>\nwhether the buttons underneath the Export values will attempt to snap the lines to their axis, or to enable smooth manual movement\n    \n<h3>Colour Tolerance</h3>\nRaise if line is not being detected, Lower if line is jagged or detecting multiple lines"},{i:"Miscellaneous",body:"You can <b>drop</b>, or <b>choose any amount of images</b> you like into the site, other than with pasting, as that only supports one image at a time.\n\n<h3>Image Editing (Ctrl + e)</h3>\nHere you can apply filters to the image that may make it trace better.\n\n<h3>Image Queue</h3>\nLoaded images show in the image queue on the bottom, and can be removed by right-clicking them (long hold on mobile), pressing <b>Remove</b> or pressing the <b>Delete</b> key on your keyboard"}];
let Z=0;var Ka;try{Ka=parseInt(window.localStorage.getItem("USER_TUTORIAL_VERSION")??0,10)}catch{Ka=0}3!==Ka&&La();
function La(){function a(){Z>=Y.length-1?n.textContent="End Tutorial":0>=Z?(n.textContent="Begin Tutorial",m.disabled=!0,m.textContent=""):(n.textContent="Next",m.disabled=!1,m.textContent="Previous");b()}function b(){const t=Y[Z]??Y[0];k.textContent=t.i;r.innerHTML=t.body}Z=0;const c=document.createElement("div"),d=document.createElement("div");d.classList.add("popupButtons");c.classList.add("popupText");const f=document.createElement("div"),k=document.createElement("h1"),l=document.createElement("button");
f.classList.add("headContainer");l.classList.add("standardButton");l.textContent="\ud800\udf22";l.addEventListener("click",q);f.append(k,l);const r=document.createElement("p");c.append(r);const n=document.createElement("button"),m=document.createElement("button");n.classList.add("standardButton");m.classList.add("standardButton");n.addEventListener("click",()=>{Z>=Y.length-1&&l.click();++Z;a()});m.addEventListener("click",()=>{--Z;a()});a();b();d.append(m,n);p([f,c,d],{buttons:d,u:["fixedSize"],onclose:Ma})}
function Ma(){window.localStorage.setItem("USER_TUTORIAL_VERSION",(3).toString())}document.getElementById("tutorial").addEventListener("click",La);document.getElementById("about").addEventListener("click",()=>{const a=document.createElement("div");a.classList.add("popupInner","about");const b=document.createElement("div");let c=null;const d=document.createElement("div");d.classList.add("logo");b.appendChild(d);b.classList.add("logoWrapper");var f=document.createElement("div"),k=document.createElement("div"),l=document.createElement("div");f.classList.add("wall");k.classList.add("wall");l.classList.add("wall");var r=document.createElement("div");
for(var n=0;16>n;++n){var m=document.createElement("div");m.style.setProperty("--i",n.toString());r.appendChild(m)}r.classList.add("line");d.append(f,k,l,r);let t,h;b.addEventListener("pointermove",L=>{L.target===L.currentTarget&&(clearTimeout(t),c=c??b.getBoundingClientRect(),d.style.setProperty("--dy",`${(L.clientX-c.left-c.width/2)/5}deg`),d.style.setProperty("--dx",`${(c.height/2-(L.clientY-c.top))/5}deg`),null==h&&(d.classList.add("quick"),h=setTimeout(()=>{d.classList.add("no-transition");d.classList.remove("quick")},
200)))});b.addEventListener("pointerleave",()=>{clearTimeout(h);h=null;t=setTimeout(()=>{d.classList.remove("quick");d.classList.remove("no-transition");d.style.removeProperty("--dx");d.style.removeProperty("--dy")},100)});b.addEventListener("dragstart",L=>L.preventDefault());f=document.createElement("div");f.classList.add("popupInner");k=document.createElement("h2");k.textContent="UsyTrace";l=document.createElement("h3");l.textContent="made with \u2764\ufe0f by usy";r=document.createElement("h6");
r.textContent="i made the 3d icon while procrastinating studying for exams, try hovering over it or dragging it";n=document.createElement("div");n.textContent="Find me at:";m=document.createElement("div");m.textContent="Discord: @usy_";const M=document.createElement("div");var H=document.createElement("a");M.textContent="Email: ";H.href="mailto:usy@usyless.uk";H.textContent="usy@usyless.uk";M.appendChild(H);H=document.createElement("div");const la=document.createElement("a");H.textContent="GitHub: ";
la.href="https://github.com/usyless/UsyTrace/issues";la.textContent="usyless";H.appendChild(la);f.append(k,l,n,m,M,H,r);a.append(b,f);p(a,{v:[{target:window,type:"resize",listener:()=>{c=b.getBoundingClientRect()}}]})});"serviceWorker"in navigator&&!["localhost","127.0.0.1"].includes(location.hostname)&&(navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}),navigator.serviceWorker.register("./service-worker.js").then(a=>{a.addEventListener("updatefound",()=>{const b=a.installing;b.addEventListener("statechange",()=>{if("installed"===b.state&&navigator.serviceWorker.controller){const c=document.getElementById("updateAvailable");c.addEventListener("click",()=>{b.postMessage({action:"skipWaiting"})});
c.classList.remove("hidden")}})})}));
